//class file
Imports System.Configuration
Imports System.Data.OleDb
Public Class Class1
    Dim cn As New OleDbConnection("Provider=Microsoft.ACE.OLEDB.12.0;Data Source='D:\.NET\.net exam\vishu\Database4.accdb'")
    Dim cm As OleDbCommand
    Dim da As OleDbDataAdapter
    Dim ds As New DataSet

    Public Sub iud(ByVal str As String)
        If cn.State = ConnectionState.Closed Then
            cn.Open()
        End If

        cm = New OleDbCommand(str, cn)
        cm.ExecuteNonQuery()
        cn.Close()
    End Sub

    Public Function display(ByVal str As String) As DataSet
        da = New OleDbDataAdapter(str, cn)
        ds.Tables.Clear()
        da.Fill(ds)
        Return ds

    End Function
End Class


//form1 
Public Class Form1
    Dim ds As New DataSet
    Dim gender As String
    Dim s As New Class1
    Dim inc, rowmax As Integer


    Private Sub Form1_Load(sender As Object, e As EventArgs) Handles MyBase.Load
        ds = s.display("select * from student")
        fill()
    End Sub

    Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
        If rdbmale.Checked = True Then
            gender = "male"
        ElseIf rdbfemale.Checked = True Then
            gender = "female"
        End If
        s.iud("insert into student(sid,sname,dob,phno,gender)values('" & TextBox1.Text & "','" & TextBox2.Text & "','" & TextBox3.Text & "','" & TextBox4.Text & "','" & gender & "')")
        fill()
    End Sub

    Public Sub fill()
        ds = s.display("select s.sid,s.sname,s.dob,s.phno,s.gender from student s order by sid")
        DataGridView1.DataSource = ds.Tables(0)
    End Sub

    Public Sub clear()
        TextBox1.Text = ""
        TextBox2.Text = ""
        TextBox3.Text = ""
        TextBox4.Text = ""
        rdbmale.Checked = False
        rdbfemale.Checked = False

    End Sub

    Private Sub Button2_Click(sender As Object, e As EventArgs) Handles Button2.Click
        If rdbmale.Checked = True Then
            gender = "male"
        ElseIf rdbfemale.Checked = True Then
            gender = "female"
        End If
        s.iud("update student set sname = '" & TextBox2.Text & "',dob = ' " & TextBox3.Text & "',phno = ' " & TextBox4.Text & "' where sid =" & TextBox1.Text)
        fill()
        clear()
    End Sub

    Private Sub Button3_Click(sender As Object, e As EventArgs) Handles Button3.Click
        If rdbmale.Checked = True Then
            gender = "male"
        ElseIf rdbfemale.Checked = True Then
            gender = "female"
        End If
        s.iud("delete from student  where sid =" & TextBox1.Text)
        fill()
        clear()
    End Sub

    Private Sub Button4_Click(sender As Object, e As EventArgs) Handles Button4.Click
        Form2.Show()
    End Sub

    Private Sub DataGridView1_CellClick(sender As Object, e As DataGridViewCellEventArgs) Handles DataGridView1.CellClick
        inc = e.RowIndex()
        TextBox1.Text = DataGridView1.Rows(inc).Cells(0).Value
        TextBox2.Text = DataGridView1.Rows(inc).Cells(1).Value
        TextBox3.Text = DataGridView1.Rows(inc).Cells(2).Value
        TextBox4.Text = DataGridView1.Rows(inc).Cells(3).Value
        If gender = "male" Then
            rdbmale.Checked = True
        ElseIf gender = "female" Then
            rdbfemale.Checked = True
        End If


    End Sub
End Class

form2//

Public Class Form2
    Dim ds As New DataSet
    Dim s As New Class1
    Private Sub Form2_Load(sender As Object, e As EventArgs) Handles MyBase.Load
        ds = s.display("select * from student")
    End Sub

    Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
        ds = s.display("select * from student where sname like '" & TextBox1.Text & "%'")
        ' ds = s.display("select * from std where name like '" & TextBox1.Text & "%' ")

        DataGridView1.DataSource = ds.Tables(0)
    End Sub
End Class

